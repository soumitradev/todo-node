title: Overview

---

### Conventions:

- This API accepts and responds only with JSON requests.
- As of now, usage of this API does NOT require an API key
- As of now, this API does NOT have any form of Authentication or Ratelimiting
- This API is CORS enabled (obviously)
- The endpoints shown use curly brackets ({}) to mark a section of the request URL as replacable using parameters
- The content type of the request must be `application/json; charset=utf-8`.

### Response Codes:

- The only HTTP status codes this API responds with are:
  - 200: OK (For successful Updating, Reading, and Deleting)
  - 201: Created (For successful Creating)
  - 400: Bad Request (For when the request is invalid)
  - 404: Not Found (For when the resource requested is not found)
  - 500: Internal Server Error (For valid, but unsuccessful requests due to an internal error)

### Schema:

- The todo schema is as follows:
  - All string fields in this schema are trimmed for whitespace. i.e. Any trailing or leading spaces are removed before evaluation.
  - Every list has a title, a description (which is empty if not provided), an id (that may be custom or auto-generated), a private boolean which is true when the list is private, and a list of tasks that contains at least 1 and at most 100 tasks.
  - Every title is a string, and is at least 1 and at most 100 characters long.
  - Every description is a string, which is at most 400 characters long. If the description is not provided, it is assumed to be an empty string.
  - Every id is unique string, which is at least 1, and at most 40 characters long. Every id must match the regular expression : `/[\w\-]/i`. This can be provided, or autogenerated. If autogenerated, it is 10 characters long by default.
  - Every task is an object with 2 properties: A task body (which is optional), and a boolean done to indicate if the task is done.
  - The task body is a string, which is at most 200 characters long. If the body is not provided, it is assumed to be an empty string.

### Endpoints:

The only endpoints as of now are:

- ```
    /api/v1/todo/
  ```

  For POST and PUT requests (to Create and Update todos)

- ```
    /api/v1/todo/{id}/
  ```

  For GET and DELETE requests (to Read and Delete todos with id `id`)

- ```
    /api/v1/todos/
  ```
  For the GET request (to Read all public todos)

## Requests:

### POST

The only endpoint that accepts POST requests is the `/api/v1/todo/` endpoint. Making a POST request to this endpoint will create a new todo with the data provided.

- On successful creation, it returns the HTTP response code `201` along with the todo created in JSON format as the response body.
- If creation is not successful, it returns the HTTP response code `400` along with the Mongo error in JSON format as the response body.

#### Example:

**Creating a new todo:**

```json
{
  "title": "ok",
  "private": false,
  "tasks": [
    {
      "body": "test",
      "done": false
    },
    {
      "done": false
    }
  ]
}
```

will return the following JSON as the response body with a status code of 201

```json
{
  "desc": "",
  "title": "ok",
  "tasks": [
    {
      "body": "test",
      "_id": "5f54903dc3bcbd243dd17fd7",
      "done": false
    },
    {
      "body": "",
      "_id": "5f54903dc3bcbd243dd17fd8",
      "done": false
    }
  ],
  "_id": "dJwFgdQaVg",
  "private": false,
  "__v": 0
}
```

> Note how the ID is auto generated, and not returned as `id` but `_id`, and that the description and body default to empty strings.

> You might notice that each task also has its own id. This id is provided by MongoDB, and doesnt have any significance in the scope of this API.

#### Errors:

**If we provide the id and another todo already has that id, then we see the following:**

Request:

```json
{
  "title": "ok",
  "id": "ok",
  "private": false,
  "tasks": [
    {
      "body": "test",
      "done": false
    },
    {
      "done": false
    }
  ]
}
```

Response (HTTP Status code 400):

```json
{
  "driver": true,
  "name": "MongoError",
  "index": 0,
  "code": 11000,
  "keyPattern": {
    "_id": 1
  },
  "keyValue": {
    "_id": "ok"
  }
}
```

**If the Schema Validation fails,**

Request:

```json
{
  "title": "okokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokok0oooooooooooooo00000000o",
  "id": "ok",
  "private": false,
  "tasks": [
    {
      "body": "test",
      "done": false
    },
    {
      "done": false
    }
  ]
}
```

Response (HTTP Status Code: 400):

```json
{
  "errors": {
    "title": {
      "name": "ValidatorError",
      "message": "Path `title` (`okokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokok0oooooooooooooo00000000o`) is longer than the maximum allowed length (100).",
      "properties": {
        "message": "Path `title` (`okokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokok0oooooooooooooo00000000o`) is longer than the maximum allowed length (100).",
        "type": "maxlength",
        "maxlength": 100,
        "path": "title",
        "value": "okokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokok0oooooooooooooo00000000o"
      },
      "kind": "maxlength",
      "path": "title",
      "value": "okokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokok0oooooooooooooo00000000o"
    }
  },
  "_message": "todoList validation failed",
  "message": "todoList validation failed: title: Path `title` (`okokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokok0oooooooooooooo00000000o`) is longer than the maximum allowed length (100)."
}
```

**If a required parameter is not provided,**

Request:

```json
{
  "private": false,
  "tasks": [
    {
      "body": "test",
      "done": false
    },
    {
      "done": false
    }
  ]
}
```

Response (HTTP Status Code 400):

```json
{
  "errors": {
    "title": {
      "name": "ValidatorError",
      "message": "Path `title` is required.",
      "properties": {
        "message": "Path `title` is required.",
        "type": "required",
        "path": "title"
      },
      "kind": "required",
      "path": "title"
    }
  },
  "_message": "todoList validation failed",
  "message": "todoList validation failed: title: Path `title` is required."
}
```

### GET

The only endpoints that accepts GET requests are the `/api/v1/todo/{id}/` and `/api/v1/todos/`. Making a GET request to these endpoints will read the todos.

The `/api/v1/todo/{id}/` endpoint returns the todo with id `id`, and the `/api/v1/todos/` returns with a list of all public todos.

- On successful reading, it returns the HTTP response code `200` along with the todo in JSON format as the response body.
- If reading is not successful due to some internal error, it returns the HTTP response code `500` along with the Mongo error in JSON format as the response body.
- If the todo is not found, it returns the HTTP response code `404` along with the following JSON error message:

```json
{
  "message": "Todo list not found"
}
```

**Note:** This request is idempotent since making many requests will not result in any different state than making one request. The state of the todo will stay the same.

#### Example:

**Making a GET request to `/api/v1/todo/joe` yielded the following JSON as the response body:**

```json
{
  "desc": "LETS GOOOO",
  "_id": "joe",
  "title": "IT WORKED",
  "tasks": [
    {
      "body": "oje",
      "_id": "5f53576fa8d141c05da694c3",
      "done": true
    },
    {
      "body": "joe",
      "_id": "5f53576fa8d141c05da694c4",
      "done": true
    }
  ],
  "private": false,
  "__v": 0
}
```

#### Errors:

**Making a GET request to `/api/v1/todo/asdf` (a non existent todo) yielded the following JSON as the response body with HTTP Status code 404:**

```json
{
  "message": "Todo list not found"
}
```

### PUT

The only endpoint that accepts PUT requests is the `/api/v1/todo/` endpoint. Making a PUT request to this endpoint will either Create a new todo with the information given, or update an existing todo.

If an existing todo has the id given, it will update that todo. Else, if no such todo is found, it will create a new todo with the information given.

If the id field itself is omitted, it will create a new todo with the information given with an automatically assigned id.

While updating an existing todo, fields not being updated can be omitted. The API will only update the fields that are given. If a field is omitted, the todo will keep its existing value for that field.

Todos can also be moved from one id to another using the `nid` field that gives the new `id` for the todo.

**Note:** If both an nid, and an id are provided, and no existing todo exists with the given id, the new todo will be assigned the `id`, not the `nid`.

**Note:** The PUT request is idempotent. i.e. Performing multiple PUT requests will result in the same result as performing one PUT request with the same data. The response is different when making more than one PUT request when moving a todo to a new id, but the state of the todo stays the same regardless, so this request is entirely idempotent.

- On successful creation, it returns the HTTP response code `201` along with the todo created in JSON format as the response body.
- On successful updating, it returns the HTTP response code `200` along with the updated todo in JSON format as the response body
- If creation or updating is not successful due to either incomplete information or an internal error, it returns the HTTP response code `400` along with the error in JSON format as the response body.

#### Examples:

**Creating a new todo (no such todo exists with id `update`):**

Request:
```json
{
  "title": "old title",
	"id": "update",
	"private": true,
  "tasks": [
    {
      "done": true,
      "body": "task 1"
    },
    {
      "done": false,
      "body": "task 2"
    }
  ]
}
```

Response (HTTP Status Code 201):
```json
{
  "desc": "",
  "title": "old title",
  "tasks": [
    {
      "body": "task 1",
      "_id": "5f54a7ef9b677f44d05a4212",
      "done": true
    },
    {
      "body": "task 2",
      "_id": "5f54a7ef9b677f44d05a4213",
      "done": false
    }
  ],
  "_id": "update",
  "private": true,
  "__v": 0
}
```

> Note that if no id was provided in the request, the API would have assigned it an autogenerated id and saved it.


**Updating an existing todo:**

We will update the todo we created in the above example

Request:
```json
{
  "title": "new title",
	"id": "update"
}
```

Response (HTTP Status Code 200):
```json
{
  "desc": "",
  "title": "new title",
  "tasks": [
    {
      "body": "task 1",
      "_id": "5f54a7ef9b677f44d05a4212",
      "done": true
    },
    {
      "body": "task 2",
      "_id": "5f54a7ef9b677f44d05a4213",
      "done": false
    }
  ],
  "_id": "update",
  "private": true,
  "__v": 0
}
```

> Note how we didn't need to provide the rest of the fields that didn't need to be updated.

**Moving an existing todo to a new id:**
Request:
```json
{
	"id": "update",
	"nid": "update-example"
}
```

Response (HTTP Status Code 200):
```json
{
  "desc": "",
  "title": "new title",
  "tasks": [
    {
      "body": "task 1",
      "_id": "5f54a7ef9b677f44d05a4212",
      "done": true
    },
    {
      "body": "task 2",
      "_id": "5f54a7ef9b677f44d05a4213",
      "done": false
    }
  ],
  "_id": "update-example",
  "private": true,
  "__v": 0
}
```

> Note again how we didn't need to provide the rest of the fields that didn't need to be updated.

#### Errors:

For Schema validation errors when updating or creating a new todo, the errors are same as the Errors documented in the POST request. 

**Other than Schema Validation errors, when moving an existing todo to a new id, if another todo already exists at that new id:**
Request:
```json
{
	"id": "update-example",
	"nid": "existing-id"
}
```

Response (HTTP Status Code 400):
```json
{
  "driver": true,
  "name": "MongoError",
  "index": 0,
  "code": 11000,
  "keyPattern": {
    "_id": 1
  },
  "keyValue": {
    "_id": "existing-id"
  }
}
```


### DELETE

The only endpoint that accepts DELETE requests is the `/api/v1/todo/{id}/` endpoint. Making a DELETE request to this endpoints will delete the todo with the given id.

- On successful deletion, it returns the HTTP response code `200` along with the todo it just deleted in JSON format as the response body.
- If reading is not successful due to some internal error, it returns the HTTP response code `500` along with the Mongo error in JSON format as the response body.
- If the todo is not found, it returns the HTTP response code `404` along with the following JSON error message:

```json
{
  "message": "Todo list not found"
}
```

**Note:** This request is also idempotent since making many requests will not result in any different state than making one request. The response will be different, but the state of the todo will stay the same.

#### Example:
Making a DELETE request to the following endpoint, we get the todo that used to exist at that id in JSON format as the response body.

Request URL:
`/api/v1/todo/update-example`

Response (HTTP Status Code 200):
```json
{
  "desc": "",
  "_id": "update-example",
  "title": "new title",
  "tasks": [
    {
      "body": "task 1",
      "_id": "5f54a7ef9b677f44d05a4212",
      "done": true
    },
    {
      "body": "task 2",
      "_id": "5f54a7ef9b677f44d05a4213",
      "done": false
    }
  ],
  "private": true,
  "__v": 0
}
```

#### Errors:

**On attempting to delete a non-existent todo:**
Since we just deleted the todo at id `update-example`, making a DELETE request to the same path will result in an error.

Request:
DELETE request to `/api/v1/todo/update-example`

Response (HTTP Status Code 404):
```json
{
  "message": "Todo list not found"
}
```
